<!doctype html>
<html lang="en" data-mode="classic">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Illumina ‚Äî Day Spreads (with Matrix)</title>
<style>
:root{--bg:#fff;--ink:#111;--soft:#e9e9e9;--gold:#caa100;--orange:#ff8a00;--grey:#7a7a7a;--accent:#caa100}
:root[data-mode="honey"]{--bg:#fffaf1;--ink:#17140f;--soft:#efe3cc;--gold:#d2a300;--orange:#ff9e33;--grey:#6a5e49;--accent:#d2a300}
:root[data-mode="neon"]{--bg:#0e0f14;--ink:#f7f7f7;--soft:#1f2230;--gold:#ffd34d;--orange:#ff7a18;--grey:#9aa0b2;--accent:#7cff00}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
.header{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap;padding:14px;border-bottom:1px solid var(--soft);position:sticky;top:0;background:var(--bg);z-index:3}
.header .btn{border:1px solid var(--soft);padding:8px 12px;border-radius:12px;background:#fff;cursor:pointer}
:root[data-mode="neon"] .header .btn{background:#121420;color:var(--ink)}
.header .btn:disabled{opacity:.4;cursor:not-allowed}
.header .title{font-weight:700;display:flex;gap:8px;align-items:center}
.header select{border:1px solid var(--soft);border-radius:10px;padding:8px 10px;background:#fff}
.grid{max-width:1200px;margin:16px auto;padding:0 16px}
.fold{position:absolute;left:calc(50% - 1px);top:0;width:2px;height:100%;background:repeating-linear-gradient(#bbb 0 8px,transparent 8px 16px);opacity:.35}
.hint{font-size:12px;opacity:.7;text-align:center;margin:10px 0}

/* Top strip (Tunes + Modes + View toggle) */
.topstrip{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:center;margin:10px 0}
.topstrip a,.topstrip button{border:1px solid var(--soft);border-radius:12px;padding:6px 10px;background:transparent;color:inherit;text-decoration:none;cursor:pointer}
.topstrip .active{outline:2px solid var(--accent);outline-offset:-2px}

/* Spread view */
.spread{display:grid;grid-template-columns:1fr 1fr;gap:20px;position:relative}
.page{border:1px solid var(--soft);border-radius:18px;padding:18px;min-height:72vh;position:relative;box-shadow:0 6px 30px rgba(0,0,0,.04);background:#fff}
:root[data-mode="neon"] .page{background:#121420}
.h1{font-size:18px;font-weight:800;margin:0 0 8px}
.sub{font-size:12px;opacity:.65;margin-bottom:12px}
.mantras{display:grid;gap:10px;margin-top:10px}
.mantras .card{border:1px solid var(--soft);border-radius:12px;padding:10px}
.label{font-size:12px;opacity:.75;margin-bottom:6px}
textarea,input[type="text"]{width:100%;border:1px solid var(--soft);border-radius:12px;padding:10px;min-height:100px;resize:vertical;font:inherit}
.small{min-height:auto}
.row{display:grid;gap:12px}
svg{width:100%;height:auto;display:block}
.meta{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}
.controls{display:flex;gap:10px;justify-content:center;margin-top:10px}
.controls .btn{border:1px solid var(--soft);padding:8px 12px;border-radius:12px;background:#fff;cursor:pointer}

/* Anchor tip */
.tip{margin:8px 0 0;font-size:12px;opacity:.8}
.badge{display:inline-block;border:1px solid var(--soft);border-radius:999px;padding:2px 8px;font-size:11px;margin-left:6px}

/* Matrix view */
#matrixWrap{display:none}
.matrixBar{display:flex;gap:8px;align-items:center;justify-content:space-between;margin:6px 0 12px}
.matrix{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
.cell{border:1px solid var(--soft);border-radius:12px;padding:10px;min-height:90px;background:#fff;display:flex;flex-direction:column;justify-content:space-between}
:root[data-mode="neon"] .cell{background:#0f1322;border-color:#2a2f44}
.cellHeader{display:flex;align-items:center;justify-content:space-between;font-size:12px}
.anchor{font-weight:700;border:1px solid var(--accent);color:var(--accent);border-radius:999px;padding:0 6px}
.titleLine{font-size:12px;opacity:.85;margin:6px 0 0;min-height:1.2em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.status{font-size:11px;opacity:.75;display:flex;gap:8px}
.dot{width:8px;height:8px;border-radius:50%;background:#d0d0d0;display:inline-block}
.dot.ok{background:#2ecc71}
.dot.mid{background:#f1c40f}
.dot.none{background:#d0d0d0}

/* Print: Spread = A3 portrait; Matrix = A3 landscape */
@page{size:A3 portrait;margin:10mm}
@media print{
  .header,.topstrip,.hint{display:none}
  .page{box-shadow:none;border:0}
}
@media (max-width:900px){.spread{grid-template-columns:1fr}.fold{display:none}}
</style>
</head>
<body>
  <div class="header">
    <button id="prev" class="btn" aria-label="Previous Day">‚óÄ</button>
    <div class="title">
      <span id="viewLabel">Spread</span> ¬∑ Illumina Day <span id="dayLabel">1</span>
      <span id="weekBadge" class="badge">Week 1</span>
      <span id="anchorBadge" class="badge" style="display:none"></span>
    </div>
    <select id="picker" aria-label="Jump to Day"></select>
    <button id="next" class="btn" aria-label="Next Day">‚ñ∂</button>
    <button id="print" class="btn" aria-label="Print">Print</button>
  </div>

  <!-- Tunes + Modes + View toggle -->
  <div class="topstrip" role="toolbar" aria-label="Global controls">
    <a id="tunesLink" href="https://tunes.plnt.earth" target="_blank" rel="noopener">üéµ Tunes</a>
    <span style="opacity:.6;font-size:12px">Mode:</span>
    <button type="button" data-mode="classic" id="modeClassic">Classic</button>
    <button type="button" data-mode="honey"   id="modeHoney">Honey</button>
    <button type="button" data-mode="neon"    id="modeNeon">Neon</button>
    <span style="opacity:.6;font-size:12px;margin-left:10px">View:</span>
    <button type="button" id="viewSpread" class="active">Spread</button>
    <button type="button" id="viewMatrix">Matrix</button>
  </div>

  <div class="grid">
    <!-- SPREAD VIEW -->
    <div id="spreadWrap">
      <div class="spread">
        <div class="fold" aria-hidden="true"></div>

        <!-- Left Page -->
        <section class="page" id="leftPage">
          <h2 class="h1">Triad ‚Ä¢ Pantheon ‚Ä¢ Watchmen</h2>
          <div class="sub">Orbit map for this cycle. Use as a compass while you work the day.</div>

          <svg viewBox="0 0 800 800" role="img" aria-label="Illumina Orbit">
            <circle cx="400" cy="400" r="140" fill="none" stroke="var(--gold)" stroke-width="3" stroke-dasharray="6 8"/>
            <circle cx="400" cy="400" r="260" fill="none" stroke="var(--orange)" stroke-width="3" stroke-dasharray="6 8"/>
            <circle cx="400" cy="400" r="360" fill="none" stroke="var(--grey)" stroke-width="3" stroke-dasharray="6 8"/>
            <g fill="var(--gold)" stroke="var(--gold)" stroke-width="2">
              <circle cx="400" cy="300" r="8"/><circle cx="320" cy="480" r="8"/><circle cx="480" cy="480" r="8"/>
            </g>
            <path d="M400 300 L320 480 L480 480 Z" fill="none" stroke="var(--gold)" stroke-width="3"/>
            <text x="400" y="272" text-anchor="middle" font-size="12">‚òÄÔ∏è Sun ‚Äî Victory</text>
            <text x="320" y="506" text-anchor="middle" font-size="12">üêù Bee ‚Äî Honey</text>
            <text x="480" y="506" text-anchor="middle" font-size="12">üåô Moon ‚Äî Archive</text>
            <g fill="var(--orange)" stroke="var(--orange)" stroke-width="2">
              <circle cx="660" cy="400" r="7"/><circle cx="530" cy="625" r="7"/><circle cx="270" cy="625" r="7"/>
              <circle cx="140" cy="400" r="7"/><circle cx="270" cy="175" r="7"/><circle cx="530" cy="175" r="7"/>
            </g>
            <path d="M660 400 L530 625 L270 625 L140 400 L270 175 L530 175 Z" fill="none" stroke="var(--orange)" stroke-width="3"/>
            <g stroke="var(--grey)" stroke-width="2" stroke-dasharray="4 6">
              <line x1="400" y1="400" x2="400" y2="40"/>
              <line x1="400" y1="400" x2="740" y2="400"/>
              <line x1="400" y1="400" x2="60"  y2="400"/>
              <line x1="400" y1="400" x2="400" y2="760"/>
              <line x1="400" y1="400" x2="660" y2="140"/>
            </g>
          </svg>

          <div class="mantras">
            <div class="card">
              <div class="label">‚òÄÔ∏è Sun mantra</div>
              <input id="sunMantra" type="text" class="small" placeholder="Victory Song cue">
            </div>
            <div class="card">
              <div class="label">üêù Bee mantra</div>
              <input id="beeMantra" type="text" class="small" placeholder="Today‚Äôs Honey Work focus">
            </div>
            <div class="card">
              <div class="label">üåô Moon mantra</div>
              <input id="moonMantra" type="text" class="small" placeholder="Archive/footnote cue">
            </div>
          </div>

          <div id="anchorTip" class="tip" style="display:none"></div>
        </section>

        <!-- Right Page -->
        <section class="page" id="rightPage">
          <h2 class="h1">Day Notes</h2>
          <div class="meta">
            <input id="dayTheme" type="text" class="small" placeholder="Theme / Title">
            <input id="dayDate"  type="text" class="small" placeholder="Date (auto)">
          </div>
          <div class="row">
            <div>
              <div class="label">üåë Weekly Intention (your words)</div>
              <textarea id="intention" placeholder="Short raw intention"></textarea>
            </div>
            <div>
              <div class="label">üõ†Ô∏è Midweek Offline Sprint ‚Äî Offline Win (your words)</div>
              <textarea id="offlineWin" placeholder="What you did independently"></textarea>
            </div>
            <div>
              <div class="label">üåï Weekly Close ‚Äî One Win (your words)</div>
              <textarea id="oneWin" placeholder="Reflection in your voice"></textarea>
            </div>
            <div>
              <div class="label">üìú Illumina Archive (continuity notes)</div>
              <textarea id="archive" placeholder="Notes you want to keep for continuity"></textarea>
            </div>
          </div>
          <div class="controls">
            <button class="btn" id="clearDay">Clear Day</button>
            <button class="btn" id="duplicatePrev">Duplicate From Previous Day</button>
          </div>
        </section>
      </div>
      <div class="hint">Use ‚óÄ ‚ñ∂ or the dropdown to move between days. Fields auto-save per day. Dates prefill for Illumina 1.</div>
    </div>

    <!-- MATRIX VIEW -->
    <div id="matrixWrap">
      <div class="matrixBar">
        <div style="font-size:14px;font-weight:700">6√ó7 Matrix ‚Äî 42 Days</div>
        <div style="font-size:12px;opacity:.7">Legend: <span class="anchor">Anchor</span> ¬∑ <span class="dot ok"></span> Intention ¬∑ <span class="dot mid"></span> One Win</div>
      </div>
      <div id="matrix" class="matrix" aria-label="42-day matrix"></div>
      <div class="hint">Tip: For printing the matrix, set your printer to A3 landscape. We auto-switch page size when printing this view.</div>
    </div>
  </div>

<script>
/* ---------- Modes (Classic/Honey/Neon) ---------- */
(function(){
  var KEY="jar_mode";
  function apply(mode){
    document.documentElement.setAttribute("data-mode", mode);
    localStorage.setItem(KEY, mode);
    ["modeClassic","modeHoney","modeNeon"].forEach(function(id){
      var b=document.getElementById(id); if(!b) return;
      b.classList.toggle("active", b.getAttribute("data-mode")===mode);
    });
  }
  var saved = localStorage.getItem(KEY) || "classic";
  apply(saved);
  ["modeClassic","modeHoney","modeNeon"].forEach(function(id){
    var b=document.getElementById(id); if(!b) return;
    b.onclick=function(){ apply(b.getAttribute("data-mode")); };
  });
})();

/* ---------- Day logic + Matrix ---------- */
(function(){
  var TOTAL=42, day=1;
  var qs=function(id){return document.getElementById(id)};
  var fields=["sunMantra","beeMantra","moonMantra","dayTheme","dayDate","intention","offlineWin","oneWin","archive"];

  // Date map (Illumina 1 ‚Äî Nov 5 ‚Üí Dec 17, 2025)
  var dayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
  var monNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
  var start = new Date(Date.UTC(2025,10,5)); // 2025-11-05
  var dates = [];
  for(var i=0;i<TOTAL;i++){
    var d=new Date(start.getTime()); d.setUTCDate(d.getUTCDate()+i);
    dates.push(dayNames[d.getUTCDay()]+" "+monNames[d.getUTCMonth()]+" "+d.getUTCDate()+", "+d.getUTCFullYear());
  }

  // Anchors
  var anchors = {1:"Ignition",14:"First Check-in",21:"Midpoint Flare",42:"Close"};
  function anchorTipText(n){
    if(n===1)  return "‚Øà Day 1 ‚Äî Ignition: set one small promise for the week.";
    if(n===14) return "‚Øà Day 14 ‚Äî Check-in: review mantras; trim any excess.";
    if(n===21) return "‚Øà Day 21 ‚Äî Midpoint: consider a small flare or interlude.";
    if(n===42) return "‚Øà Day 42 ‚Äî Close: capture one win and archive cleanly.";
    return "";
  }

  function key(f){return "illumina_day_"+day+"_"+f}
  function saveField(id){ localStorage.setItem(key(id), qs(id).value) }
  function loadField(id){
    var stored = localStorage.getItem(key(id));
    if(id==="dayDate"){
      qs(id).value = (stored!==null && stored!=="") ? stored : dates[day-1];
    }else{
      qs(id).value = stored || "";
    }
  }
  function loadAll(){ fields.forEach(loadField) }

  function bindSave(){ fields.forEach(function(id){ qs(id).oninput=function(){ saveField(id) } }) }

  function weekFor(d){ return "Week "+(Math.floor((d-1)/7)+1) }

  function updateHeader(){
    qs("dayLabel").textContent=day;
    qs("weekBadge").textContent=weekFor(day);

    var ab=qs("anchorBadge");
    if(anchors[day]){ ab.style.display="inline-block"; ab.textContent="Anchor: "+anchors[day]; }
    else{ ab.style.display="none"; }

    qs("prev").disabled=(day===1);
    qs("next").disabled=(day===TOTAL);
    qs("picker").value=String(day);

    // Anchor tip
    var tip = qs("anchorTip");
    var t = anchorTipText(day);
    tip.style.display = t ? "block":"none";
    tip.textContent = t;
  }

  function populatePicker(){
    var p=qs("picker");
    for(var i=1;i<=TOTAL;i++){
      var o=document.createElement("option");
      o.value=String(i);
      var label="Day "+i+" ‚Äî "+dates[i-1];
      if(anchors[i]) label+="  ‚Øà";
      o.textContent=label;
      p.appendChild(o);
    }
  }

  function goTo(d){
    day=Math.min(Math.max(1,d),TOTAL);
    updateHeader();
    loadAll();
    // Focus first empty field hint (optional: no focus to avoid mobile keyboard pop)
  }

  function clearDay(){
    fields.forEach(function(id){ localStorage.removeItem(key(id)) });
    loadAll();
    buildMatrix(); // reflect immediately
  }

  function duplicatePrev(){
    if(day<=1) return;
    fields.forEach(function(id){
      var v=localStorage.getItem("illumina_day_"+(day-1)+"_"+id)||"";
      if(id==="dayDate" && v===""){ v=dates[day-1]; }
      localStorage.setItem(key(id), v);
    });
    loadAll();
    buildMatrix();
  }

  // Matrix helpers
  function getVal(n, f){
    return localStorage.getItem("illumina_day_"+n+"_"+f) || "";
  }
  function statusFor(n){
    // ok = intention present, mid = oneWin present
    var ok = getVal(n,"intention").trim().length>0;
    var mid= getVal(n,"oneWin").trim().length>0;
    return {ok:ok, mid:mid};
  }

  function openDay(n){
    // switch to spread + navigate
    activateView("spread");
    goTo(n);
    window.scrollTo({top:0,behavior:"smooth"});
  }

  function buildMatrix(){
    var host=qs("matrix"); host.innerHTML="";
    for(var n=1;n<=TOTAL;n++){
      var cell=document.createElement("button");
      cell.className="cell";
      cell.type="button";
      cell.onclick=(function(x){return function(){ openDay(x); };})(n);

      var head=document.createElement("div");
      head.className="cellHeader";

      var left=document.createElement("div");
      left.textContent="Day "+n;

      var right=document.createElement("div");
      if(anchors[n]){
        var anc=document.createElement("span");
        anc.className="anchor";
        anc.textContent="‚Øà";
        anc.title=anchors[n];
        right.appendChild(anc);
      }

      head.appendChild(left); head.appendChild(right);
      cell.appendChild(head);

      var title=document.createElement("div");
      title.className="titleLine";
      var t = getVal(n,"dayTheme").trim();
      title.textContent = t || dates[n-1];
      cell.appendChild(title);

      var st=document.createElement("div");
      st.className="status";
      var s=statusFor(n);
      var dot1=document.createElement("span"); dot1.className="dot "+(s.ok?"ok":"none"); dot1.title="Intention";
      var dot2=document.createElement("span"); dot2.className="dot "+(s.mid?"mid":"none"); dot2.title="One Win";
      st.appendChild(dot1); st.appendChild(dot2);
      cell.appendChild(st);

      host.appendChild(cell);
    }
  }

  // View switching
  function activateView(name){
    var spread = qs("spreadWrap"), matrix = qs("matrixWrap");
    var vlabel = qs("viewLabel");
    if(name==="matrix"){
      spread.style.display="none"; matrix.style.display="block";
      vlabel.textContent="Matrix";
      // Switch print page size for matrix
      var style = document.getElementById("printStyle");
      if(!style){ style=document.createElement("style"); style.id="printStyle"; document.head.appendChild(style); }
      style.textContent="@page{size:A3 landscape;margin:10mm}";
      qs("viewMatrix").classList.add("active"); qs("viewSpread").classList.remove("active");
      buildMatrix();
    }else{
      spread.style.display="block"; matrix.style.display="none";
      vlabel.textContent="Spread";
      var style = document.getElementById("printStyle");
      if(!style){ style=document.createElement("style"); style.id="printStyle"; document.head.appendChild(style); }
      style.textContent="@page{size:A3 portrait;margin:10mm}";
      qs("viewSpread").classList.add("active"); qs("viewMatrix").classList.remove("active");
    }
  }

  // Init
  populatePicker(); bindSave(); goTo(1); activateView("spread");

  // Wire header controls
  qs("prev").onclick=function(){ goTo(day-1) };
  qs("next").onclick=function(){ goTo(day+1) };
  qs("picker").onchange=function(){ goTo(parseInt(this.value,10)) };
  qs("print").onclick=function(){ window.print() };
  qs("clearDay").onclick=clearDay;
  qs("duplicatePrev").onclick=duplicatePrev;

  document.addEventListener("keydown",function(e){
    var tag=e.target.tagName;
    if(tag==="TEXTAREA"||tag==="INPUT") return;
    if(e.key==="ArrowLeft") goTo(day-1);
    if(e.key==="ArrowRight") goTo(day+1);
    if(e.key.toLowerCase()==="m") activateView("matrix");
    if(e.key.toLowerCase()==="s") activateView("spread");
  });

  qs("viewSpread").onclick=function(){ activateView("spread") };
  qs("viewMatrix").onclick=function(){ activateView("matrix") };
})();
</script>
</body>
</html>
