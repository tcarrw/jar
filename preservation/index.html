<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Illumina Preservation Table</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --pepper:#0d0d0d;
      --ink:#1a1a1a;
      --line:#444;
      --honey:#ffeb3b;
      --honey-deep:#ffb300;
      --moon:#00e5ff;
      --moon-deep:#00acc1;
      --rose:#ff80ab;
      --paper:#eaeaea;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      font-family: Georgia, serif;
      color: #f5f5f5;
      background: var(--pepper);
      overflow-x: hidden;
    }

    /* Animated background */
    .bg {
      position: fixed;
      inset: 0;
      z-index: -2;
      background: radial-gradient(1200px 800px at 20% 30%, rgba(255,235,59,0.12), transparent 60%),
                  radial-gradient(1000px 700px at 80% 70%, rgba(0,229,255,0.12), transparent 60%),
                  linear-gradient(120deg, #0b0b0b, #0f0f0f 40%, #0b0b0b 80%);
      animation: drift 28s ease-in-out infinite alternate;
      filter: saturate(110%);
    }
    @keyframes drift {
      0%   { transform: translate3d(0,0,0) scale(1); }
      100% { transform: translate3d(0,-10px,0) scale(1.02); }
    }

    /* Stars */
    .stars {
      position: fixed;
      inset: 0;
      z-index: -1;
      background-image:
        radial-gradient(2px 2px at 15% 20%, rgba(255,255,255,0.12), transparent 60%),
        radial-gradient(1.5px 1.5px at 35% 70%, rgba(255,255,255,0.10), transparent 60%),
        radial-gradient(1.8px 1.8px at 70% 40%, rgba(255,255,255,0.08), transparent 60%),
        radial-gradient(1.2px 1.2px at 85% 15%, rgba(255,255,255,0.09), transparent 60%),
        radial-gradient(1.6px 1.6px at 55% 10%, rgba(255,255,255,0.07), transparent 60%);
      background-repeat: no-repeat;
      animation: twinkle 9s linear infinite;
      pointer-events: none;
    }
    @keyframes twinkle {
      0%,100% { opacity: 0.5; transform: translateY(0); }
      50%     { opacity: 0.9; transform: translateY(-6px); }
    }

    /* Nav */
    nav {
      width: 100%;
      background: rgba(13,13,13,0.9);
      backdrop-filter: blur(6px);
      padding: 0.8rem 1rem;
      text-align: center;
      border-bottom: 2px solid #222;
      box-shadow: 0 0 10px rgba(255,255,255,0.08);
      position: sticky;
      top: 0;
      z-index: 5;
    }
    nav a, .sound-btn {
      margin: 0 1.0rem;
      text-decoration: none;
      font-size: 1rem;
      letter-spacing: 0.6px;
      display: inline-block;
      position: relative;
      transition: transform 0.3s ease, text-shadow 0.3s ease, opacity 0.3s ease;
      cursor: pointer;
      background: none;
      border: none;
      font: inherit;
    }
    nav a:nth-child(1) { color: var(--honey); text-shadow: 0 0 6px var(--honey); animation: pulseHoney 6s infinite; }
    nav a:nth-child(2) { color: var(--moon);  text-shadow: 0 0 6px var(--moon);  animation: pulseMoon 7s infinite;  }
    nav a:nth-child(3) { color: var(--rose);  text-shadow: 0 0 6px var(--rose);  animation: pulseInter 8s infinite; }
    nav a:hover, .sound-btn:hover { text-shadow: 0 0 12px #fff, 0 0 20px currentColor; transform: scale(1.08); }

    .sound-btn {
      color: #cfcfcf;
      text-shadow: 0 0 5px rgba(255,255,255,0.2);
      border-bottom: 1px dotted rgba(255,255,255,0.25);
    }
    .sound-on { color: #9eff9e; text-shadow: 0 0 8px #9eff9e; border-bottom-color: #9eff9e; }

    @keyframes pulseHoney {
      0%,100% { text-shadow: 0 0 6px var(--honey), 0 0 12px var(--honey-deep); }
      50%     { text-shadow: 0 0 14px #fff176, 0 0 20px var(--honey); }
    }
    @keyframes pulseMoon {
      0%,100% { text-shadow: 0 0 6px var(--moon), 0 0 12px var(--moon-deep); }
      50%     { text-shadow: 0 0 14px #80d8ff, 0 0 22px var(--moon); }
    }
    @keyframes pulseInter {
      0%,100% { text-shadow: 0 0 6px var(--rose), 0 0 12px #ec407a; }
      50%     { text-shadow: 0 0 14px #ffb6c1, 0 0 22px var(--rose); }
    }

    main {
      padding: 2rem 1rem 3rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    h1 {
      font-size: 2rem;
      margin: 1.2rem 0 1.2rem;
      text-align: center;
      letter-spacing: 1px;
      color: #ffd54f;
      text-shadow: 0 0 8px var(--honey-deep);
    }
    table {
      border-collapse: collapse;
      background: var(--ink);
      box-shadow: 0 0 15px rgba(255,255,255,0.18);
      width: 100%;
      max-width: 850px;
      color: var(--paper);
    }
    th, td {
      border: 1px solid var(--line);
      padding: 1rem;
      text-align: center;
      vertical-align: middle;
    }
    th {
      background: #262626;
      font-weight: bold;
      color: var(--honey);
      text-shadow: 0 0 6px var(--honey);
    }
    tr:nth-child(even) { background: #141414; }
    td { font-size: 0.95rem; }

    .footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      text-align: center;
      color: #aaa;
    }
    .footer a {
      color: var(--moon);
      text-decoration: none;
      text-shadow: 0 0 5px var(--moon);
    }
    .footer a:hover {
      text-shadow: 0 0 12px #fff, 0 0 18px var(--moon);
    }
  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="stars"></div>

  <nav>
    <a href="/calendar/illumina1/">üåë Calendar</a>
    <a href="/reference/">üìì Reference</a>
    <a href="/interludes/">‚ú® Interludes</a>
    <button class="sound-btn" id="soundBtn" aria-pressed="false" aria-label="Toggle ambient sound">üîä Sound</button>
  </nav>

  <main>
    <h1>üåï Illumina Preservation Table</h1>
    <table>
      <tr>
        <th>Element</th>
        <th>Role</th>
        <th>Preserves</th>
        <th>Illumina Symbolism</th>
      </tr>
      <tr>
        <td>üçØ Honey (Bee)</td>
        <td>Sweetness, flow, taste, energy</td>
        <td>Intentions, warmth, living memory</td>
        <td>üêù Connection, pollination, continuity</td>
      </tr>
      <tr>
        <td>üåô Silica (Moon)</td>
        <td>Dryness, structure, crystal dust</td>
        <td>Records, archives, form</td>
        <td>‚óØ Circle, sealed archive, time capsule</td>
      </tr>
      <tr>
        <td>‚ö™ Jar (Vessel)</td>
        <td>Container, seal, walled garden</td>
        <td>The union of Bee + Moon</td>
        <td>üîÑ Harmony of organic + mineral</td>
      </tr>
      <tr>
        <td>‚ú® Combination</td>
        <td>Double preservation, redundancy</td>
        <td>Prevents decay + loss</td>
        <td>üåü Preserve the sweetness without rot</td>
      </tr>
    </table>

    <div class="footer">
      <p>Part of <a href="https://jar.plnt.earth/">jar.plnt.earth</a> ¬∑ Linked from Reference + Pantheon</p>
    </div>
  </main>

  <script>
    let ctx, master, pads = [];
    const btn = document.getElementById('soundBtn');

    function startAudio() {
      if (ctx) return;
      ctx = new (window.AudioContext || window.webkitAudioContext)();
      master = ctx.createGain();
      master.gain.value = 0.06;
      master.connect(ctx.destination);

      function mkPad(freq, detune, gainVal, panPos, driftAmt, driftTime) {
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        const pan = (ctx.createStereoPanner) ? ctx.createStereoPanner() : null;

        osc.type = 'sine';
        osc.frequency.value = freq;
        osc.detune.value = detune;

        gain.gain.value = 0.0;
        const now = ctx.currentTime;
        gain.gain.linearRampToValueAtTime(gainVal, now + 2.5);

        if (pan) {
          pan.pan.value = panPos;
          osc.connect(gain); gain.connect(pan); pan.connect(master);
        } else {
          osc.connect(gain); gain.connect(master);
        }
        osc.start();

        const drift = ctx.createOscillator();
        drift.type = 'sine';
        drift.frequency.value = driftTime; // slow LFO
        const driftGain = ctx.createGain();
        driftGain.gain.value = driftAmt;
        drift.connect(driftGain);
        driftGain.connect(osc.frequency);
        drift.start();

        return { osc, gain, drift, driftGain, pan };
      }

      pads.push(mkPad(110,  -6, 0.18, -0.3, 1.2, 0.035));
      pads.push(mkPad(220,  +3, 0.12,  0.3, 0.8,  0.048));
      pads.push(mkPad(176, +12, 0.10,  0.0, 0.6,  0.062));

      const shimmer = ctx.createOscillator();
      const shimmerGain = ctx.createGain();
      shimmer.type = 'triangle';
      shimmer.frequency.value = 2.2;
      shimmerGain.gain.value = 0.008;
      shimmer.connect(shimmerGain);
      shimmerGain.connect(master);
      shimmer.start();

      btn.classList.add('sound-on');
      btn.setAttribute('aria-pressed','true');
    }

    function stopAudio() {
      if (!ctx) return;
      pads.forEach(p => {
        const t = ctx.currentTime + 1.2;
        p.gain.gain.linearRampToValueAtTime(0, t);
        setTimeout(() => {
          try { p.osc.stop(); p.osc.disconnect(); p.drift.stop(); } catch(e){}
        }, 1400);
      });
      pads = [];
      try { ctx.close(); } catch(e){}
      ctx = null;
      btn.classList.remove('sound-on');
      btn.setAttribute('aria-pressed','false');
    }

    btn.addEventListener('click', () => {
      if (!ctx) startAudio(); else stopAudio();
    });

    document.addEventListener('visibilitychange', () => {
      if (document.hidden && ctx) stopAudio();
    }, { passive: true });
  </script>
</body>
</html>
