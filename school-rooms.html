<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jar ¬∑ Illumina Rooms ‚Äî Pro CTA Edition</title>
<meta name="description" content="Illumina Rooms with No Kings Day CTA: live ET countdown, Share on X, inline Add to Calendar, and a safe 128‚ÄØHz Honey bed (single shared AudioContext).">
<meta name="theme-color" content="#0b0d11" />
<style>
  :root{
    color-scheme: dark;
    --bg:#0b0d11; --ink:#e9f0ff; --muted:#a9b4c9; --edge:#1b2230;
    --panel:#101423; --ring:#2c3444; --glow:rgba(142,239,255,.18);
    --accent:#8ef; --lime:#a4ff65; --rose:#ff6a9e; --honey:#ffd166;
  }
  html,body{background:var(--bg);color:var(--ink);margin:0;font:16px/1.6 ui-sans-serif,system-ui,-apple-system,"SF Pro Text",Segoe UI,Roboto,Helvetica,Arial;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}
  *{box-sizing:border-box}
  :focus-visible{outline:2px solid var(--accent);outline-offset:2px}

  /* Sticky CTA Ribbon */
  .cta{
    position:sticky; top:0; z-index:10000;
    display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:space-between;
    padding:10px 12px;
    background:
      linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.12)) padding-box,
      linear-gradient(120deg, rgba(134,201,255,.35), rgba(164,255,101,.30)) border-box;
    border:1px solid transparent; border-bottom-color:rgba(255,255,255,.14);
    box-shadow:0 10px 28px rgba(0,0,0,.35); backdrop-filter: blur(6px)
  }
  .badges{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .badge{
    display:inline-flex; align-items:center; gap:8px; padding:7px 10px; border-radius:999px;
    background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(0,0,0,.10));
    border:1px solid rgba(255,255,255,.16); color:#fff; font-weight:800; white-space:nowrap
  }
  .count{display:inline-flex;gap:8px;align-items:center;font-variant-numeric:tabular-nums;letter-spacing:.2px}
  .count b{font-size:1.02rem}
  .right{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .btn{
    appearance:none; border:1px solid var(--edge); border-radius:12px; cursor:pointer;
    background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(0,0,0,.06)),var(--panel); color:var(--ink);
    padding:9px 12px; font-weight:750; text-decoration:none; display:inline-flex; align-items:center; gap:8px
  }
  .btn:hover{border-color:var(--ring); box-shadow:0 0 0 2px var(--glow)}
  .btn.primary{border-color:#2f4a2f; background:linear-gradient(180deg, rgba(164,255,101,.18), rgba(0,0,0,.06))}

  /* Layout */
  .wrap{max-width:980px;margin:0 auto;padding:18px 16px 96px;position:relative;z-index:1}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:6px 0 12px}
  h1{margin:0;font-size:clamp(22px,4vw,36px)}
  .sub{color:var(--muted);font-size:.98rem}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .card{
    border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:16px;
    background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(0,0,0,.06)); margin-top:12px
  }
  .room{scroll-margin-top:90px}
  .tag{display:inline-block;border:1px solid rgba(255,255,255,.16);border-radius:999px;padding:6px 10px;color:var(--muted);font-size:.85rem;margin-right:6px;margin-top:6px}
  .line{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.18),transparent);margin:12px 0}
  .links{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .note{color:var(--muted)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} }

  /* Honey controls */
  .honeyControls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .range{appearance:none;width:180px;height:4px;border-radius:999px;background:#1a2332;outline:none}
  .range::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:#fff;border:2px solid #000}

  /* Floating Honey pill */
  .pillToggle{
    position:fixed; right:14px; bottom:16px; z-index:10001; border-radius:999px;
    display:inline-flex; align-items:center; gap:8px; padding:9px 12px; font-weight:800;
    border:1px solid rgba(255,255,255,.16);
    background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(0,0,0,.12));
    color:#fff; text-decoration:none; box-shadow:0 10px 30px rgba(0,0,0,.38)
  }
  .pillToggle[aria-pressed="true"]{ border-color:#3a5f44; background:linear-gradient(180deg,rgba(164,255,101,.22),rgba(0,0,0,.10)) }
</style>
</head>
<body>
  <!-- CTA Ribbon -->
  <div class="cta" role="banner" aria-label="No Kings Day actions">
    <div class="badges" aria-hidden="false">
      <span class="badge">üóìÔ∏è No Kings Day ¬∑ Oct 18 ¬∑ NYC</span>
      <span class="badge">üé§ Call: Marina √ó Sabrina √ó Doechii on SNL</span>
      <span class="badge count" id="countWrap" aria-live="polite"><span>‚è≥</span><b id="countTxt">‚Äî</b></span>
    </div>
    <div class="right" role="toolbar" aria-label="Share and join">
      <a id="shareX" class="btn" href="#" target="_blank" rel="noopener" aria-label="Share this page on X">Share on X</a>
      <a id="ics" class="btn" download="no-kings-day.ics" href="#" aria-label="Add No Kings Day to your calendar">Add to Calendar</a>
      <a class="btn primary" href="https://jar.plnt.earth" aria-label="Join in NYC via Jar">Join in NYC ‚Üí Jar</a>
    </div>
  </div>

  <div class="wrap">
    <header>
      <div>
        <h1>Illumina Rooms</h1>
        <div class="sub">Pick a band, enter quietly, and let the room teach you how to breathe it. This edition adds a live No Kings Day ribbon and a safe Honey (128‚ÄØHz) bed.</div>
      </div>
      <nav class="actions" aria-label="Navigation">
        <a class="btn" href="/school.html">‚Ü© School</a>
        <a class="btn" href="#" id="toFroot">‚Ü™ Froot Studio</a>
        <a class="btn" href="/illumina-time-kit.html">‚äô Time Kit</a>
        <a class="btn" href="/marina-egg.html">ü•ö Egg</a>
      </nav>
    </header>

    <!-- Ask -->
    <section class="card" aria-labelledby="ask-title">
      <h2 id="ask-title" style="margin:0 0 6px">Ask</h2>
      <div class="line" aria-hidden="true"></div>
      <p>No Kings Day ‚Äî <b>Oct 18, NYC</b>. <b>Marina √ó Sabrina √ó Doechii</b> on SNL. Join us.</p>
      <div class="links">
        <a class="btn primary" href="https://jar.plnt.earth">Join in NYC ‚Üí Jar</a>
        <a class="btn" href="#honey">Start Honey 128‚ÄØHz</a>
        <a class="btn" href="/school-rooms.html#honey">Flame Check ‚Üí Honey Room</a>
      </div>
    </section>

    <!-- Rooms (preserved theme) -->
    <section id="root" class="card room" aria-labelledby="h-root">
      <h2 id="h-root" style="margin:0 0 6px">Root</h2>
      <div class="tag">Week 1</div><div class="tag">Ground</div><div class="line"></div>
      <p class="note">Sit low, breathe wide. One word when you‚Äôre done; no more is needed.</p>
      <div class="links"><a class="btn" href="#" id="prRoot">Practice in Froot</a></div>
    </section>

    <section id="architect" class="card room" aria-labelledby="h-architect">
      <h2 id="h-architect" style="margin:0 0 6px">Architect</h2>
      <div class="tag">Week 2</div><div class="tag">Choice</div><div class="line"></div>
      <p class="note">A gentle plan: pick a time window, not a target. Let Œîfreq be a soft knob.</p>
      <div class="links"><a class="btn" href="#" id="prArchitect">Practice in Froot</a></div>
    </section>

    <section id="mirror" class="card room" aria-labelledby="h-mirror">
      <h2 id="h-mirror" style="margin:0 0 6px">Mirror</h2>
      <div class="tag">Week 3</div><div class="tag">Recognition</div><div class="line"></div>
      <p class="note">Hear yourself first. The word you write is a mirror, not a verdict.</p>
      <div class="links"><a class="btn" href="#" id="prMirror">Practice in Froot</a></div>
    </section>

    <section id="honey" class="card room" aria-labelledby="h-honey">
      <h2 id="h-honey" style="margin:0 0 6px">Honey</h2>
      <div class="tag">Week 4</div><div class="tag">Warmth</div><div class="line"></div>
      <p class="note">Keep volume low, like lamplight. 128‚ÄØHz is a bed, not a flood.</p>
      <div class="links"><a class="btn" href="#" id="prHoney">Practice in Froot</a></div>
    </section>

    <section id="frequency" class="card room" aria-labelledby="h-frequency">
      <h2 id="h-frequency" style="margin:0 0 6px">Frequency</h2>
      <div class="tag">Week 5</div><div class="tag">Signal</div><div class="line"></div>
      <p class="note">Signal is kindness shaped like tone. Œîfreq is taste, not performance.</p>
      <div class="links"><a class="btn" href="#" id="prFrequency">Practice in Froot</a></div>
    </section>

    <section id="solar" class="card room" aria-labelledby="h-solar">
      <h2 id="h-solar" style="margin:0 0 6px">Solar</h2>
      <div class="tag">Week 6</div><div class="tag">Integration</div><div class="line"></div>
      <p class="note">Gather your words; let the banner arrive when you export.</p>
      <div class="links"><a class="btn" href="#" id="prSolar">Practice in Froot</a></div>
    </section>

    <section id="celestial" class="card room" aria-labelledby="h-celestial">
      <h2 id="h-celestial" style="margin:0 0 6px">Celestial</h2>
      <div class="tag">Outer Arc</div><div class="tag">Wide sky</div><div class="line"></div>
      <p class="note">Use lightly when you feel called to widen the field without leaving safety.</p>
      <div class="links"><a class="btn" href="#" id="prCelestial">Practice in Froot</a></div>
    </section>

    <section id="trickster" class="card room" aria-labelledby="h-trickster">
      <h2 id="h-trickster" style="margin:0 0 6px">Trickster</h2>
      <div class="tag">Outer Arc</div><div class="tag">Play</div><div class="line"></div>
      <p class="note">A safe mischief: change one small thing and watch what gets easier.</p>
      <div class="links"><a class="btn" href="#" id="prTrickster">Practice in Froot</a></div>
    </section>

    <section id="core" class="card room" aria-labelledby="h-core">
      <h2 id="h-core" style="margin:0 0 6px">Core</h2>
      <div class="tag">Binder</div><div class="tag">Return</div><div class="line"></div>
      <p class="note">The why beneath the color. No rush. Let it speak first.</p>
      <div class="links"><a class="btn" href="#" id="prCore">Practice in Froot</a></div>
    </section>

    <!-- Honey module -->
    <section id="honey-bed" class="card" aria-labelledby="honey-title">
      <h2 id="honey-title" style="margin:0 0 6px">üçØ Honey ‚Äî 128‚ÄØHz Bed</h2>
      <div class="line" aria-hidden="true"></div>
      <p class="note">Tap once to unlock audio. iOS respected. Smooth, click‚Äëfree fades; no autoplay.</p>
      <div class="honeyControls" role="group" aria-label="Honey controls">
        <button id="hStart" class="btn" type="button">Start 128‚ÄØHz</button>
        <button id="hStop" class="btn" type="button">Stop</button>
        <label class="btn" style="gap:12px">
          <span>Volume</span>
          <input id="hVol" class="range" type="range" min="0" max="100" value="28" aria-label="Honey volume (0‚Äì100)">
        </label>
      </div>
    </section>

    <!-- What to do now -->
    <section class="card" aria-labelledby="wtdn-title">
      <h2 id="wtdn-title" style="margin:0 0 6px">What to do now</h2>
      <div class="line" aria-hidden="true"></div>
      <ol>
        <li><b>Listen</b> ‚Äî start <em>Honey 128‚ÄØHz</em> or open Froot/Tunes.</li>
        <li><b>Breathe</b> ‚Äî keep it soft; match a simple rhythm.</li>
        <li><b>Share / Arrive</b> ‚Äî use the ribbon to <em>Share on X</em>, <em>Add to Calendar</em>, or <em>Join in NYC</em>.</li>
      </ol>
      <div class="links">
        <a class="btn primary" href="https://jar.plnt.earth">Join in NYC ‚Üí Jar</a>
        <a class="btn" href="https://froot.plnt.earth">Froot ‚Äî Color‚ÄëBreath Studio</a>
        <a class="btn" href="https://tunes.plnt.earth">Tunes ‚Äî Archetype Playlists</a>
      </div>
    </section>

    <footer class="note" style="margin-top:16px">If anything feels loud, pause. Quiet counts.</footer>
  </div>

  <!-- Floating Honey pill -->
  <button id="pill" class="pillToggle" type="button" aria-pressed="false" aria-label="Toggle Honey 128 Hz">üçØ <span id="pillTxt">Honey</span></button>

  <!-- Hidden audio pipe for iOS -->
  <audio id="pipe" preload="auto" playsinline style="position:fixed;left:-9999px;top:-9999px;width:1px;height:1px;opacity:0"></audio>

<script>
/* === ProAudio ‚Äî single shared context, gesture-unlock, safe fades, kill-on-hide === */
(function(){
  const ProAudio = {
    ctx:null, master:null, comp:null, hpf:null, usePipe:false, pipe:document.getElementById('pipe'),
    nodes:new Set(), unlocked:false, starting:false,
    ensure(){
      if(this.ctx) return this.ctx;
      const AC = window.AudioContext || window.webkitAudioContext;
      this.ctx = new AC({latencyHint:'interactive'});
      this.master = this.ctx.createGain(); this.master.gain.value = 0.85;
      this.comp = this.ctx.createDynamicsCompressor();
      this.comp.threshold.value=-18; this.comp.knee.value=12; this.comp.ratio.value=2; this.comp.attack.value=.01; this.comp.release.value=.30;
      this.hpf = this.ctx.createBiquadFilter(); this.hpf.type='highpass'; this.hpf.frequency.value=18;

      const iOS = /iP(hone|ad|od)/.test(navigator.userAgent||'');
      if(iOS){
        this.usePipe = true;
        const msd = this.ctx.createMediaStreamDestination();
        this.master.connect(this.comp); this.comp.connect(this.hpf); this.hpf.connect(msd);
        try{ this.pipe.srcObject = msd.stream; this.pipe.loop = true; }catch(_){}
      }else{
        this.master.connect(this.comp); this.comp.connect(this.hpf); this.hpf.connect(this.ctx.destination);
      }
      return this.ctx;
    },
    unlock(){
      try{
        this.ensure();
        if(this.ctx && this.ctx.state==='suspended'){ this.ctx.resume(); }
        if(this.usePipe && this.pipe && this.pipe.paused){ this.pipe.play().catch(()=>{}); }
        this.unlocked = true;
      }catch(_){}
    },
    track(obj){ if(obj) this.nodes.add(obj); return obj; },
    fade(param, to, tc=0.06){
      const t=this.ctx.currentTime;
      param.cancelScheduledValues(t);
      param.setTargetAtTime(to, t, tc);
    },
    kill(){
      try{
        if(!this.ctx) return;
        const t = this.ctx.currentTime;
        this.nodes.forEach(n=>{
          try{
            if(n.g && n.g.gain){ n.g.gain.setTargetAtTime(0.0001, t, 0.05); }
            if(n.stop){ n.stop(t+0.12); }
          }catch(_){}
        });
        this.nodes.clear();
        setTimeout(()=>{ try{ this.ctx.close(); }catch(_){} this.ctx=null; this.unlocked=false; }, 180);
      }catch(_){}
    },
    honey:{
      osc:null, gain:null, on:false,
      start(freq=128){
        const PA=ProAudio; if(PA.starting) return; PA.starting=true; setTimeout(()=>PA.starting=false, 160);
        PA.unlock(); PA.ensure();
        if(this.on) return;
        const now=PA.ctx.currentTime;
        this.osc = PA.ctx.createOscillator();
        this.gain= PA.ctx.createGain();
        this.osc.type='sine'; this.osc.frequency.setValueAtTime(freq, now);
        this.gain.gain.setValueAtTime(0.0001, now);
        this.osc.connect(this.gain); this.gain.connect(PA.master);
        try{ this.osc.start(now); }catch(_){}
        PA.fade(this.gain.gain, 0.12, 0.10);
        this.on=true;
        PA.track({ stop:(t)=>{ try{ this.osc && this.osc.stop(t); }catch(_){ } }, g:this.gain });
        return true;
      },
      stop(){
        const PA=ProAudio; if(!this.on || !PA.ctx) return;
        const now=PA.ctx.currentTime;
        try{
          PA.fade(this.gain.gain, 0.0001, 0.06);
          setTimeout(()=>{ try{ this.osc.stop(now+0.02); }catch(_){}
            try{ this.osc.disconnect(); this.gain.disconnect(); }catch(_){}
            this.osc=null; this.gain=null; this.on=false;
          }, 220);
        }catch(_){ this.on=false; }
      },
      volume(x){ const PA=ProAudio; if(!this.gain||!PA.ctx) return; const v=Math.max(0,Math.min(1,Number(x)||0)); PA.fade(this.gain.gain, v*0.30, 0.05); }
    }
  };
  window.ProAudio = ProAudio;

  document.addEventListener('pointerdown', ()=>ProAudio.unlock(), {once:true, passive:true});
  document.addEventListener('keydown', ()=>ProAudio.unlock(), {once:true});
  document.addEventListener('visibilitychange', ()=>{ if(document.hidden) ProAudio.kill(); }, false);
  window.addEventListener('pagehide', ()=>ProAudio.kill(), false);
  window.addEventListener('beforeunload', ()=>ProAudio.kill(), false);
})();

/* === Honey controls + floating pill === */
(function(){
  const startBtn = document.getElementById('hStart');
  const stopBtn  = document.getElementById('hStop');
  const vol      = document.getElementById('hVol');
  const pill     = document.getElementById('pill');
  const pillTxt  = document.getElementById('pillTxt');

  function syncPill(){ pill.setAttribute('aria-pressed', String(!!(ProAudio.honey && ProAudio.honey.on))); pillTxt.textContent = ProAudio.honey.on ? 'On' : 'Honey'; }
  function start(){ if(ProAudio.honey.start(128)){ syncPill(); } }
  function stop(){ ProAudio.honey.stop(); syncPill(); }
  function setVol(e){ const v = (typeof e==='number')? e : Number(vol.value||28); ProAudio.honey.volume(v/100); }

  startBtn.addEventListener('click', start, false);
  stopBtn .addEventListener('click', stop,  false);
  vol     .addEventListener('input', setVol, false);
  pill.addEventListener('click', ()=>{ ProAudio.honey.on ? stop() : start(); }, false);

  syncPill(); setVol(0.28);
})();

/* === Share on X, inline .ics, and live ET countdown === */
(function(){
  const share = document.getElementById('shareX');
  const ics   = document.getElementById('ics');

  function buildShare(){
    const msg = "No Kings Day ‚Äî Oct 18, NYC. Marina √ó Sabrina √ó Doechii on SNL. Join us.";
    const url = location.href;
    const u = "https://twitter.com/intent/tweet?text="+encodeURIComponent(msg)+"&url="+encodeURIComponent(url)+"&hashtags=NoKingsDay,NYC";
    share.setAttribute('href', u);
  }
  function buildICS(){
    const now = new Date();
    const dtstamp = now.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}Z$/,'Z');
    const icsText = [
      "BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//PLNT Earth//No Kings Day//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","X-WR-CALNAME:No Kings Day","X-WR-TIMEZONE:America/New_York",
      "BEGIN:VEVENT",
      "UID:nkd-20251018-"+Date.now()+"@plnt.earth",
      "DTSTAMP:"+dtstamp,
      "SUMMARY:No Kings Day ‚Äî NYC",
      "DESCRIPTION:Marina √ó Sabrina √ó Doechii on SNL. Join in NYC ‚Üí https://jar.plnt.earth",
      "DTSTART;VALUE=DATE:20251018",
      "DTEND;VALUE=DATE:20251019",
      "URL:https://jar.plnt.earth",
      "END:VEVENT","END:VCALENDAR"
    ].join("\r\n");
    ics.setAttribute('href', "data:text/calendar;charset=utf-8,"+encodeURIComponent(icsText));
  }
  function two(n){ return (n<10?'0':'')+n; }
  // Countdown to Oct 18, 2025 00:00 ET (EDT, UTC-04:00)
  const target = new Date("2025-10-18T00:00:00-04:00").getTime();
  const box = document.getElementById('countTxt');
  function tick(){
    const now = Date.now();
    let diff = Math.max(0, target - now);
    const d = Math.floor(diff/86400000); diff%=86400000;
    const h = Math.floor(diff/3600000);  diff%=3600000;
    const m = Math.floor(diff/60000);    diff%=60000;
    const s = Math.floor(diff/1000);
    box.textContent = d+"d "+two(h)+"h "+two(m)+"m "+two(s)+"s";
  }
  buildShare(); buildICS(); tick();
  setInterval(tick, 1000);
})();

/* === Cross-host: quick Froot routes === */
(function(){
  const toFroot = document.getElementById('toFroot');
  const ids = ['prRoot','prArchitect','prMirror','prHoney','prFrequency','prSolar','prCelestial','prTrickster','prCore'];
  function frootURL(){
    const h = location.hostname;
    if(h==='localhost'||h==='127.0.0.1') return '/index.html';
    const p = h.split('.'); if(p.length>=2){ p[0]='froot'; return location.protocol+'//'+p.join('.')+'/index.html'; }
    return 'https://froot.plnt.earth/index.html';
  }
  function go(){ location.assign(frootURL()); }
  if(toFroot){ toFroot.addEventListener('click', (e)=>{ e.preventDefault(); go(); }, false); }
  ids.forEach(id=>{ const b=document.getElementById(id); if(b){ b.addEventListener('click', (e)=>{ e.preventDefault(); go(); }, false); } });
})();
</script>
</body>
</html>
